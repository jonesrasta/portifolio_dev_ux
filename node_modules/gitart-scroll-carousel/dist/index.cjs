"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var r=require("vue"),M=require("./GSArrow.js"),j=require("./GSLayoutDefault.js"),U=require("./GSLayoutNumeric.js");function W(e,t){function n(...o){e(()=>t.apply(this,o),{fn:t,thisArg:this,args:o})}return n}function H(e,t={}){let n,o;return l=>{const s=r.unref(e),a=r.unref(t.maxWait);if(n&&clearTimeout(n),s<=0||a!==void 0&&a<=0)return o&&(clearTimeout(o),o=null),l();a&&!o&&(o=setTimeout(()=>{n&&clearTimeout(n),o=null,l()},a)),n=setTimeout(()=>{o&&clearTimeout(o),o=null,l()},s)}}function Z(e,t=!0,n=!0){let o=0,c,l=!n;const s=()=>{c&&(clearTimeout(c),c=void 0)};return f=>{const m=r.unref(e),y=Date.now()-o;if(s(),m<=0)return o=Date.now(),f();y>m&&(o=Date.now(),l?l=!1:f()),t&&(c=setTimeout(()=>{o=Date.now(),n||(l=!0),s(),f()},m)),!n&&!c&&(c=setTimeout(()=>l=!0,m))}}function J(e,t=200,n={}){return W(H(t,n),e)}function K(e,t=200,n=!0,o=!0){return W(Z(t,n,o),e)}var Q=4,Y=.001,X=1e-7,x=10,P=11,L=1/(P-1),ee=typeof Float32Array=="function";function B(e,t){return 1-3*t+3*e}function $(e,t){return 3*t-6*e}function C(e){return 3*e}function N(e,t,n){return((B(t,n)*e+$(t,n))*e+C(t))*e}function D(e,t,n){return 3*B(t,n)*e*e+2*$(t,n)*e+C(t)}function te(e,t,n,o,c){var l,s,a=0;do s=t+(n-t)/2,l=N(s,o,c)-e,l>0?n=s:t=s;while(Math.abs(l)>X&&++a<x);return s}function re(e,t,n,o){for(var c=0;c<Q;++c){var l=D(t,n,o);if(l===0)return t;var s=N(t,n,o)-e;t-=s/l}return t}function ne(e){return e}var oe=function(t,n,o,c){if(!(0<=t&&t<=1&&0<=o&&o<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===n&&o===c)return ne;for(var l=ee?new Float32Array(P):new Array(P),s=0;s<P;++s)l[s]=N(s*L,t,o);function a(f){for(var m=0,y=1,g=P-1;y!==g&&l[y]<=f;++y)m+=L;--y;var p=(f-l[y])/(l[y+1]-l[y]),d=m+p*L,v=D(d,t,o);return v>=Y?re(f,d,t,o):v===0?d:te(f,m,m+L,t,o)}return function(m){return m===0?0:m===1?1:N(a(m),n,c)}};const ie={ease:[.25,.1,.25,1],linear:[0,0,1,1],easeIn:[.42,0,1,1],easeOut:[0,0,.58,1],easeInOut:[.42,0,.58,1],default:[.5,0,.5,1]},le={FPS:60,BEZIER:ie.default},ae=({from:e,to:t,duration:n,bezier:o=le.BEZIER,on:c,completed:l,stopped:s,done:a})=>{const f=oe(...o),m=t-e,y=Date.now();let g=0,p=e;const d=()=>{let v=(Date.now()-y)/n;if(v>1&&(v=1),p=e+m*f(v),c(p),v===1){l==null||l(p),a==null||a(p);return}g=requestAnimationFrame(d)};return g=requestAnimationFrame(d),()=>{cancelAnimationFrame(g),s==null||s(p),a==null||a(p)}},se=e=>{let t=0,n=null;return{setSmoothly:(l,s)=>{n==null||n(),s&&(t=s),n=ae({duration:400,from:t,to:l,on:a=>{t=a,e(a)}})},setImmediately:l=>{t=l,e(l)}}};const ce=r.defineComponent({name:"GSIndicator",props:{barWidthPercent:{type:Number,required:!0},barOffsetPercent:{type:Number,required:!0}},emits:{"smooth-scroll":e=>!0,scroll:e=>!0,"scroll:start":()=>!0,"scroll:end":()=>!0},setup(e,{emit:t}){const n=r.ref(),o=r.ref(0),c=r.ref(0),l=r.ref(!1),s=g=>{const d=g.clientX-o.value,v=n.value.offsetWidth,w=d/v*100,T=0,h=100-e.barWidthPercent;let I=c.value+w;I<T?I=T:I>h&&(I=h),t("scroll",{barOffsetPercent:I})},a=()=>{document.removeEventListener("mouseup",a),document.removeEventListener("mousemove",s),l.value=!1,t("scroll:end")},f=g=>{l.value=!0,t("scroll:start"),document.addEventListener("mouseup",a),document.addEventListener("mousemove",s),o.value=g.clientX,c.value=e.barOffsetPercent},m=g=>{const p=g.clientX,d=n.value,v=d.getBoundingClientRect().left,h=((p-v)/d.offsetWidth-e.barWidthPercent/100/2)*100;t("smooth-scroll",{barOffsetPercent:h})},y=r.computed(()=>({width:`${e.barWidthPercent}%`,left:`${e.barOffsetPercent}%`}));return{indicatorRef:n,barStyle:y,startBarX:o,startBarOffsetPercent:c,moving:l,onTrackClick:m,onMouseDown:f}}});function ue(e,t,n,o,c,l){return r.openBlock(),r.createElementBlock("div",{ref:"indicatorRef",class:r.normalizeClass(["gsc-indicator",{"gsc-indicator--scrolling":e.moving}])},[r.createElementVNode("div",{class:"gsc-indicator__track",onClick:t[0]||(t[0]=(...s)=>e.onTrackClick&&e.onTrackClick(...s))}),r.createElementVNode("div",{class:"gsc-indicator__bar",style:r.normalizeStyle(e.barStyle),onMousedown:t[1]||(t[1]=(...s)=>e.onMouseDown&&e.onMouseDown(...s))},null,36)],2)}var fe=M._export_sfc(ce,[["render",ue],["__scopeId","data-v-1dcebdc5"]]);const de=r.defineComponent({name:"GSCarousel",components:{GSIndicator:fe},props:{currentItem:{type:Number,default:0},items:{type:Array,required:!0},itemsToShow:{type:Number,required:!0},keyField:{type:String,default:null},itemGap:{type:[String,Number],default:"0",validator:e=>{const t=e.toString().split(" ");return t.length<=2&&t.every(n=>!isNaN(parseInt(n)))}},previewSize:{type:Number,default:120},sticky:{type:Boolean,default:!1},layout:{type:Object,required:!0},layoutProps:{type:Object,required:!1,default:null},ssrItemMinWidth:{type:[Number,String],default:null},ssrItemMaxWidth:{type:[Number,String],default:null}},emits:{"update:current-item":e=>!0},setup(e,{emit:t,expose:n}){const o=r.ref(!1),c=r.ref(),l=r.ref("left"),s=r.ref(0),a=r.ref(e.currentItem||0);r.watch(()=>e.currentItem,i=>{a.value=i});const f=r.reactive({isScrolling:!1,barOffsetPercent:0,barWidthPercent:0}),m=r.computed(()=>{const i=f.barOffsetPercent/(100-f.barWidthPercent);return Math.floor(i*(e.items.length-1))}),{setImmediately:y,setSmoothly:g}=se(i=>{var u;return(u=c.value)==null?void 0:u.scrollTo({left:i})}),p=r.computed(()=>{const i=e.itemGap.toString().split(" ").map(S=>parseInt(S)),u=i[0],b=i.length===1?u:i[1];return{y:u,x:b}}),d=r.computed(()=>s.value?(s.value-e.previewSize)/e.itemsToShow:0),v=(i,u=!0)=>{if(u){const b=c.value.scrollLeft;g(i,b)}else y(i)},w=()=>{const i=c.value.scrollLeft,u=i/d.value,b=1-(u-Math.floor(u));let S;return b<.09?S=Math.floor(u)+1:S=Math.floor(u),S*d.value<i&&(S+=1),S>e.items.length-1&&(S=e.items.length-1),S},T=i=>{const u=c.value.scrollLeft,b=w();if(i===1){let S=b+e.itemsToShow;b*d.value-e.previewSize-2>u&&(S-=1);const z=e.items.length-e.itemsToShow;S>z&&(S=z);const V=d.value*S;v(V)}else if(i===-1){if(b===0)return;let S=b-e.itemsToShow;S<0&&(S=0);const E=d.value*S-e.previewSize;v(E)}},h=i=>{if(!d.value){setTimeout(()=>{h(i)},50);return}if(i>w()){const b=d.value*i;v(b);return}const u=d.value*i-e.previewSize;v(u)},I=K(()=>{const i=w();i!==a.value&&(a.value=i,t("update:current-item",a.value))},200);let O=0;const F=J(i=>{if(y(i),!(!e.sticky||f.isScrolling)){if(O<i){const u=d.value*a.value;v(u)}else if(Math.abs(d.value*a.value-i)>e.previewSize+2){const u=d.value*(a.value-1)-e.previewSize;v(u)}O=i}},300),G=()=>{const i=c.value.scrollLeft;i<2?l.value="left":c.value.scrollWidth<=i+c.value.offsetWidth+2?l.value="right":l.value="none",f.barOffsetPercent=i/c.value.scrollWidth*100,I(),F(i)},q=({barOffsetPercent:i},u=!1)=>{const b=c.value.scrollWidth*(i/100);v(b,u)},_=i=>{f.isScrolling=i};let k=null;r.onMounted(()=>{k=new ResizeObserver(([i])=>{window.requestAnimationFrame(()=>{s.value=i.contentRect.width,r.nextTick(()=>{f.barWidthPercent=s.value/c.value.scrollWidth*100})})}),k.observe(c.value),o.value=!0,a.value!==0&&h(a.value)}),r.onBeforeUnmount(()=>{k==null||k.disconnect()});const R=r.computed(()=>Object.entries({"--gsc-item-gap-y":p.value.y,"--gsc-item-gap-x":p.value.x,"--gsc-item-ssr-min-width":e.ssrItemMinWidth?`${parseInt(e.ssrItemMinWidth.toString())}px`:"","--gsc-item-ssr-max-width":e.ssrItemMaxWidth?`${parseInt(e.ssrItemMaxWidth.toString())}px`:""}).reduce((i,[u,b])=>`${i}${u}: ${b};`,"")),A=r.computed(()=>({width:`calc((100% - ${e.previewSize}px) / ${e.itemsToShow})`}));return n({onMove:T,onMoveTo:h}),{trackRef:c,styles:R,itemStyle:A,initialized:o,disabledSide:l,indicatorOptions:f,scopedCurrentItem:a,currentItemByPercent:m,onMove:T,onMoveTo:h,onTrackScroll:G,onIndicatorScroll:q,onSetIndicatorScrollStatus:_}}}),me={class:"gsc-track__inner"};function ve(e,t,n,o,c,l){const s=r.resolveComponent("GSIndicator");return r.openBlock(),r.createElementBlock("div",{class:r.normalizeClass(["gsc",{"gsc--scrolling":e.indicatorOptions.isScrolling,"gsc--initialized":e.initialized}]),style:r.normalizeStyle(e.styles)},[(r.openBlock(),r.createBlock(r.resolveDynamicComponent(e.layout),r.mergeProps({"on-move":e.onMove,"on-move-to":e.onMoveTo,"disabled-side":e.disabledSide,"current-item":e.scopedCurrentItem,"current-item-by-percent":e.currentItemByPercent,items:e.items,initialized:e.initialized},e.layoutProps),{track:r.withCtx(()=>[r.createElementVNode("div",{ref:"trackRef",class:"gsc-track",onScrollPassive:t[0]||(t[0]=(...a)=>e.onTrackScroll&&e.onTrackScroll(...a))},[r.createElementVNode("div",me,[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(e.items,(a,f)=>(r.openBlock(),r.createElementBlock("div",{key:e.keyField?a[e.keyField]:f,class:"gsc-track__item",style:r.normalizeStyle(e.itemStyle)},[r.renderSlot(e.$slots,"item",{data:a,index:f})],4))),128))])],544)]),indicator:r.withCtx(()=>[r.createVNode(s,{"bar-offset-percent":e.indicatorOptions.barOffsetPercent,"bar-width-percent":e.indicatorOptions.barWidthPercent,onSmoothScroll:t[1]||(t[1]=a=>e.onIndicatorScroll(a,!0)),onScroll:e.onIndicatorScroll,"onScroll:start":t[2]||(t[2]=a=>e.onSetIndicatorScrollStatus(!0)),"onScroll:end":t[3]||(t[3]=a=>e.onSetIndicatorScrollStatus(!1))},null,8,["bar-offset-percent","bar-width-percent","onScroll"])]),_:3},16,["on-move","on-move-to","disabled-side","current-item","current-item-by-percent","items","initialized"]))],6)}var Se=M._export_sfc(de,[["render",ve]]);exports.GSLayoutDefault=j.GSLayoutDefault;exports.GSLayoutNumeric=U.GSLayoutNumeric;exports.GSCarousel=Se;
//# sourceMappingURL=index.cjs.map
